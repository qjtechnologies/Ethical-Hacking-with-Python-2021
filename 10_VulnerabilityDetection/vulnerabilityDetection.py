import socket

white_list = [
    '220 (vsFTPd 3.0.3)'
]


def isVulnerable(banner):
    global white_list
    for vulnerability in white_list:
        # print(vulnerability,banner)
        if vulnerability in str(banner):
            return True
    return False


if __name__ == "__main__":
    ip = "192.168.109.82"
    port_list = [20, 21, 22, 23, 53, 80]
    socket.setdefaulttimeout(2)
    for port in port_list:
        print(f"Scanning Port {port}")
        try:
            # initialize Socket
            s = socket.socket()
            # Connect to server
            s.connect((ip, port))
            # Receive application banner
            banner = s.recv(1024)
            print("Banner", banner)
            # print("Vulnerable",isVulnerable(banner))
            if(isVulnerable(banner)):
                print("[-] Application is Vulnerable running on port", port, "\n")
            else:
                print("[+] Not Vulnerable\n")
        except Exception as e:
            # Continue if not able to connect on requested port
            continue
